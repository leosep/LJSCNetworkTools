import importlib
import os

def list_exploits():
    exploits = []
    for file in os.listdir("exploits"):
        if file.endswith(".py") and file != "__init__.py" and file != "exploit_base.py":
            exploits.append(file.replace(".py", ""))
    return exploits

def load_exploit(name):
    module = importlib.import_module(f"exploits.{name}")
    exploit_class = getattr(module, [attr for attr in dir(module) if not attr.startswith("_")][0])
    return exploit_class()

def run_exploit():
    print("Available Exploits:")
    exploits = list_exploits()
    for i, exploit in enumerate(exploits, 1):
        print(f"{i}. {exploit}")

    choice = int(input("Select an exploit: "))
    if 1 <= choice <= len(exploits):
        exploit_name = exploits[choice - 1]
        exploit = load_exploit(exploit_name)
        target = input("Enter target: ")
        exploit.execute(target)
    else:
        print("Invalid choice, returning to main menu.")
